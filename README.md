# üõ∏ ufo-vm
–≠—Ç–æ —Å—Ä–µ–¥—Å—Ç–≤–æ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–µ–µ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –¥–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è. 
–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π intel –ø–æ–¥–æ–±–Ω—ã–π –∞—Å—Å–µ–º–±–ª–µ—Ä —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π. 
–í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è 16 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –æ–ø–µ—Ä–∞–Ω–¥–æ–≤ –∏ –¥–∞–Ω–Ω—ã—Ö.

## ‚öô –°–∏–Ω—Ç–∞–∫—Å–∏—Å
–í –ª–∏—Å—Ç–∏–Ω–≥–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –º–æ–∂–Ω–æ –ø—Ä–æ–∏–Ω–∏–∑–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ–≥–º–µ–Ω—Ç—ã –∫–æ–¥–∞ –∏ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏ –Ω–∞—á–∞–ª–µ –æ–ø–∏—Å–∞–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–∞, 
—Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤—ã `.code` –∏–ª–∏ `.data` —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–µ–Ω–Ω–æ. –ü–æ—Å–ª–µ –≤—Å—Ç—Ä–µ—á–∏ —Å –æ–¥–Ω–æ–π –∏–∑ –¥–∏—Ä–µ–∫—Ç–∏–≤, 
–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ä–µ–∂–∏–º –∞–Ω–∞–ª–∏–∑–∞ —Å–µ–≥–º–µ–Ω—Ç–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–µ–≥–º–µ–Ω—Ç –¥–∞–Ω–Ω—ã—Ö –Ω–µ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–¥, 
–∞ —Å–µ–≥–º–µ–Ω—Ç –∫–æ–¥–∞ - –¥–∞–Ω–Ω—ã–µ. –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –Ω–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –æ—Ç—Å—Ç—É–ø–∞–º, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –≤–æ–ª–µ–Ω —Ä–∞—Å—Å—Ç–∞–≤–ª—è—Ç—å –∏—Ö –ø–æ —Å–≤–æ–µ–º—É —É—Å–º–æ—Ç—Ä–µ–Ω–∏—é.
  
–í –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ—á–∫–∏, –∞ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –≤–æ–∑–æ–∂–Ω–æ—Å—Ç—å –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ 
—Å –ø–æ–º–æ—â—å—é —Å–∏–º–≤–æ–ª–∞ `#`. –í—Å–µ, —á—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–æ —Å–ø—Ä–∞–≤–∞ –æ—Ç `#`, —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º –∏ –Ω–∏–∫–∞–∫ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º.

### –°–µ–≥–º–µ–Ω—Ç .data
–í –æ–±—â–µ–º —Å–ª—É—á–∞–µ, –∫–∞–∂–¥–∞—è –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ —Å–µ–≥–º–µ–Ω—Ç–µ –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –≤–∏–¥:  
`[–º–µ—Ç–∫–∞] <—Ç–∏–ø> [–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä]`  

–ê—Å—Å–µ–º–±–ª–µ—Ä –ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —Å —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö:
| –¢–∏–ø |  –ò–º—è  |  –†–∞–∑–º–µ—Ä –≤ –±–∞–π—Ç–∞—Ö | 
|-----|-------|------------------|
|  db | byte  | 1                |
|  dh | short | 2                |
|  dw | dwort | 4                |
|  dq | qword | 8                |
  
–ú–æ–∂–Ω–æ –±—ã–ª–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∏–º—è –º–µ—Ç–∫–∏ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–≤—Å–µ–º –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –ø—Ä–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ –±—É—Ñ–µ—Ä–∞ –ø–∞–º—è—Ç–∏, c–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ - 
—É–∫–∞–∑–∞—Ç—å —Ç–∏–ø. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è –∑–∞–Ω—É–ª—è—é—Ç—Å—è. 

–ú–µ—Ç–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –∞–¥—Ä–µ—Å–∞—Ü–∏–∏ —è—á–µ–µ–∫ –ø–∞–º—è—Ç–∏ –≤ —Å–µ–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞.
  
–°–ª–µ–¥—É—é—â–∏–π –ª–∏—Å—Ç–∏–Ω–≥ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–∞ –¥–∞–Ω–Ω—ã—Ö:
```
.data
  banner    db    "Hello world!"
  binData   db    file(data.bin)
  byte_2    db    -100
  byte_3    db    0xff

  buff32    dq
            dq
            dq
            dq
```
  
–ê—Å—Å–µ–º–±–ª–µ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤ –≤ –∫–∞—á–µ—Ç—Å–≤–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤ –ø–∞–º—è—Ç–∏. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ, 
—Ä–∞–∑–º–µ—Ä –≤—ã–¥–µ–ª—è–µ–º–æ–π –ø–∞–º—è—Ç–∏ –±—É–¥–µ—Ç –∑–∞–≤–∏—Å–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞, –∞ –Ω–µ –æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö.
–û–¥–Ω–∞–∫–æ, –≤ –≤—ã—à–µ –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö —Ö–æ—Ä–æ—à–∏–º —Ç–æ–Ω–æ–º —Å—á–∏—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `db` –≤ –∫–∞—á–µ—Ç—Å–≤–µ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö.  
  
–°—Ç—Ä–æ–∫–∏, –∫–∞–∫ –∏ –±–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤, –±—É–¥—É—Ç —Ä–∞—Å–ø–æ–ª–æ–≥–∞—Ç—å—Å—è –≤ –ø—è–º—è—Ç–∏ –≤ –Ω—É–ª—å-—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ.

### –°–µ–≥–º–µ–Ω—Ç .code
–í –æ–±—â–µ–º —Å–ª—É—á–∞–µ, –∫–∞–∂–¥–∞—è –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ —Å–µ–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞ –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –≤–∏–¥:  
`<–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è> [–æ–ø–µ—Ä–∞–Ω–¥—ã...]`
  
#### –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Å –∫—Ä–∞—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º:
| –ò–Ω—Ç—Ä—É–∫—Ü–∏—è | –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ                                  | –û–ø–µ—Ä–∞–Ω–¥ 1     | –û–ø–µ—Ä–∞–Ω–¥ 2     | –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö  |
|-----------|---------------------------------------------------|---------------|---------------|--------------|
| **exit**  | –í—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã                                |               |               | db dh dw dq  |
| **mov**   | –ü–µ—Ä–µ–Ω–æ—Å –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ op2 –≤ op1                     | MEM           | LIT           | db dh dw dq  |
|           |                                                   | MEM           | MEM           |              |
|           |                                                   | MEM           | PTR           |              |
|           |                                                   | PTR           | MEM           |              |
| **add**   | –°—É–º–º–∞ –æ–ø–µ—Ä–∞–Ω–¥–æ–≤                                   | MEM           | LIT           | db dh dw dq  |
|           |                                                   | MEM           | MEM           |              |
|           |                                                   | MEM           | PTR           |              |
| **sub**   | –†–∞–∑–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞–Ω–¥–æ–≤                                | MEM           | LIT           | db dh dw dq  |
|           |                                                   | MEM           | MEM           |              |
|           |                                                   | MEM           | PTR           |              |
| **mul**   | –£–º–Ω–æ–∂–µ–Ω–∏–µ –æ–ø–µ—Ä–∞–Ω–¥–æ–≤                               | MEM           | LIT           | db dh dw dq  |
|           |                                                   | MEM           | MEM           |              |
|           |                                                   | MEM           | PTR           |              |
| **div**   | –î–µ–ª–µ–Ω–∏–µ op1 –Ω–∞ op2                                | MEM           | LIT           | db dh dw dq  |
|           |                                                   | MEM           | MEM           |              |
|           |                                                   | MEM           | PTR           |              |
| **xor**   | –õ–æ–≥–∏—á–µ—Å–∫–æ–µ –ø–æ–±–∏—Ç–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ                   | MEM           | LIT           | db dh dw dq  |
|           |                                                   | MEM           | MEM           |              |
|           |                                                   | MEM           | PTR           |              |
| **and**   | –õ–æ–≥–∏—á–µ—Å–∫–æ–µ –ò                                      | MEM           | LIT           | db dh dw dq  |
|           |                                                   | MEM           | MEM           |              |
|           |                                                   | MEM           | PTR           |              |
| **or**    | –õ–æ–≥–∏—á–µ—Å–∫–æ–µ –ò–õ–ò                                    | MEM           | LIT           | db dh dw dq  |
|           |                                                   | MEM           | MEM           |              |
|           |                                                   | MEM           | PTR           |              |
| **rand**  | –°–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0, op2]              | MEM           | LIT           | db dh        |
|           |                                                   | MEM           | MEM           |              |
|           |                                                   | MEM           | PTR           |              |
| **ror**   | –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥ –Ω–∞ op2 –≤–ø—Ä–∞–≤–æ                   | MEM           | LIT           | db dh dw dq  |
|           |                                                   | MEM           | MEM           |              |
|           |                                                   | MEM           | PTR           |              |
| **rol**   | –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥ –Ω–∞ op2 –≤–ª–µ–≤–æ                    | MEM           | LIT           | db dh dw dq  |
|           |                                                   | MEM           | MEM           |              |
|           |                                                   | MEM           | PTR           |              |
| **lea**   | –ü–æ–ª—É—á–∏—Ç—å –∞–¥—Ä–µ—Å op2                                | MEM           | MEM           | dh           |
| **jmp**   | –ü–µ—Ä–µ–Ω–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ –∞–¥—Ä–µ—Å op1, –µ—Å–ª–∏ op2 –Ω–µ –Ω–æ–ª—å | CMEM          | LIT           | db dh dw dq  |
|           |                                                   | CMEM          | MEM           |              |
|           |                                                   | CMEM          | PTR           |              |
|           |                                                   | CPTR          | MEM           |              |
| **put**   | –í—ã–≤–µ—Å—Ç–∏ op1 –≤ –∫–æ–Ω—Å–æ–ª—å                             | LIT           |               | db           |
|           |                                                   | MEM           |               |              |
|           |                                                   | PTR           |               |              |
| **get**   | –ü–æ–ª—É—á–∏—Ç—å —Å–∏–º–≤–æ–ª –∏–∑ –±—É—Ñ–µ—Ä–∞ –≤–≤–æ–¥–∞                   | MEM           |               | db           |
|           |                                                   | PTR           |               |              |

–ï—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ—Å—ë—Ç –∫–∞–∫–æ–π-–ª—é–±–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –æ–Ω –≤—Å–µ–≥–¥–∞ –∑–∞–Ω–æ—Å–∏—Ç—Å—è –≤ –ø–µ—Ä–≤—ã–π –æ–ø–µ—Ä–∞–Ω–¥.  
  
–ö–∞–∫ –≤–∏–¥–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–µ, –∫–∞–∂–¥–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—å —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –æ–ø–µ—Ä–∞–Ω–¥–æ–≤:
* LIT - –ª–∏—Ç–µ—Ä–∞–ª, –∑–∞–¥–∞–≤–∞–µ–º—ã–π –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ
* MEM - –º–µ—Ç–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–æ —Å—É—Ç–∏ –º–∞–∫—Ä–æ—Å, –≤–º–µ—Å—Ç–æ –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∞–¥—Ä–µ—Å)
* PTR - –º–µ—Ç–∫–∞ –Ω–∞ —É–∫–∞–∑–∞—Ç–µ–ª—å —Å–µ–≥–º–µ–Ω—Ç–∞ –¥–∞–Ω–Ω—ã—Ö (—É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –º–µ—Å—Ç–æ –≤ –ø–∞–º—è—Ç–∏, —Ö—Ä–∞–Ω—è—â–µ–µ –∫–æ–Ω–µ—á–Ω—ã–π –∞–¥—Ä–µ—Å) 
* CMEM - –º–µ—Ç–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–∞ –∫–æ–¥–∞
* CPTR - –º–µ—Ç–∫–∞ –≤ —Å–µ–≥–º–µ–Ω—Ç–µ –¥–∞–Ω–Ω—ã—Ö, —É–∫–∞–∑—ã–≤–∞—é—â–∞—è –Ω–∞ –º–µ—Å—Ç–æ –≤ —Å–µ–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ª–∏—Å—Ç–∏–Ω–≥ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞:  
```
.data
    ptr  dh
    a    dw   
    b    dw   

.code
ptr:
    movw  a, 291     # MEM, LIT
    leah  ptr, a     # MEM, MEM
    movw  b, [ptr]   # MEM, PTR
    movw  [ptr], a   # PTR, MEM

    jmpb ptr, 1
```
  
–ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∫–∞–∂–¥–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏–º–µ–µ—Ç –ø–æ—Å—Ç—Ñ–∏–∫—Å, —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—é—â–∏–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, —Å –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–Ω—Ç—Å—Ä—É–∫—Ü–∏—è.
–ò—Å—Ö–æ–¥—è –∏–∑ —ç—Ç–æ–≥–æ, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `movw  a, 291` –ø–æ–º–µ—â–∞–µ—Ç –ø–æ –∞–¥—Ä–µ—Å—É `a` —á–∏—Å–ª–æ `291`, –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤ —á–µ—Ç—ã—Ä–µ –±–∞–π—Ç–∞ —Å –ø–æ—Ä—è–¥–∫–æ–º
little-endian (–≤ –ø–∞–º—è—Ç–∏ –±—É–¥–µ—Ç –∏–º–µ—Ç—å –≤–∏–¥ `0x23 0x01 0x00 0x00`).  

–°–ª–µ—É–¥–µ—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, —Å –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `lea`. –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –≤—Å–µ –∞–¥—Ä–µ—Å–∞ –∏–º–µ—é—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤
–¥–≤–∞ –±–∞–π—Ç–∞, –±—É–¥—å —Ç–æ —Å–µ–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –∏–ª–∏ –¥–∞–Ω–Ω—ã—Ö. 

> –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã, –≤—Å–µ –∞–¥—Ä–µ—Å–∞ —è–≤–ª—è—é—Ç—Å—è —Å–º–µ—â–µ–Ω–∏—è–º–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—á–∞–ª–∞ —Å–µ–≥–º–µ–Ω—Ç–∞

–ò–º–µ–Ω–∞ –º–µ—Ç–æ–∫ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤, —Ç–æ –µ—Å—Ç—å –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏ –≤ –¥—Ä—É–≥–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ (–≤ –ø—Ä–∏–º–µ—Ä–µ `ptr` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ).
–ü—Ä–∏—á–∏–Ω–∞ –∫—Ä–æ–µ–∫—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–∫ –∫–æ–¥–∞ –∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç—Å—è. –ú–µ—Ç–∫–∏ –∫–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–µ—Ä–≤–æ–≥–æ –æ–ø–µ—Ä–∞–Ω–¥–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ `jmp`, –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è
–º–µ—Å—Ç–∞ –ø—Ä—ã–∂–∫–∞.

–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—É—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é –∞–¥—Ä–µ—Å–Ω—É—é –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
```
    movw  ptr+2, 100
```
–ø–æ–ª–æ–∂–∏–ª–∞ –±—ã –∑–Ω–∞—á–µ–Ω–∏–µ `100` –ø–æ –∞–¥—Ä–µ—Å—É –º–µ—Ç–∫–∏ `a`  
  
–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —Å–∫–æ–±–æ—á–∫–∏, –æ–∫—Ä—É–∂–∞—é—â–∏–µ –æ–ø–µ—Ä–∞–Ω–¥, –æ–±–æ–∑–Ω–∞—á–∞—é—Ç, —á—Ç–æ –æ–Ω —è–≤–ª—è–µ—Ç—Å—è –ø–æ–∏–Ω—Ç–µ—Ä–æ–º, —Ç–æ –µ—Å—Ç—å –æ–ø–µ—Ä–∞–Ω–¥ —Ö—Ä–∞–Ω–∏—Ç –≤ —Å–µ–±–µ –∞–¥—Ä–µ—Å, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –æ–±—Ä–∞—â–∞—Ç—å—Å—è.
```
    movw  b, [ptr]
```
—Ç–æ –µ—Å—Ç—å, –¥–∞–Ω–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –∏–∑ `ptr`, –∞ –∏–∑ –∞–¥—Ä–µ—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–∂–∏—Ç –≤ `ptr`.  
  
### –†–µ–≥–∏—Å—Ç—Ä—ã
–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Å—è—Ç—å –≤–æ—Å—å–º–∏–±–∞–π—Ç–Ω—ã—Ö "—Ä–µ–≥–∏—Å—Ç—Ä–æ–≤" –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –í –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä, –ø–æ —Å—É—Ç–∏, –≤—Å–µ–≥–æ –ª–∏—à—å –±—É—Ñ—Ñ–µ—Ä –ø–∞–º—è—Ç–∏ —Å 
–ø—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –∏–º–µ–Ω–µ–º.  

–†–µ–≥–∏—Å—Ç—Ä—ã:
* rip
* r1-10

`rip` –∂–µ –æ—Ç–ª–∏—á–∞–µ—Ç –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç–æ, —á—Ç–æ –æ–Ω —Ö—Ä–∞–Ω–∏—Ç –∞–¥—Ä–µ—Å —Ç–µ–∫—É—â–µ–π –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–π –∏–Ω—Ç—Ä—É–∫—Ü–∏–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∏–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏.
  
### –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
–¢–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –º–µ—Ç–∫–∞ `start` –≤ —Å–µ–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞. –ü—Ä–∏ –µ—ë –æ—Ç—Å—É—Ç—Å–≤–∏–∏, —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è.

## ‚öô –ö–æ–º–ø–∏–ª—è—Ü–∏—è
### –ú–µ—Ç–∫–∏
–í –ø–∞—Ä–∞–≥—Ä–∞—Ñ–µ –æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–æ –∞–Ω–∞–ª–∏–∑ –º–µ—Ç–æ–∫.

### –¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è
–û–ø–∫–æ–¥ –∫–∞–∂–¥–æ–π –∏–Ω—Ç—Ä—É–∫—Ü–∏–∏ —É–º–µ—â–∞–µ—Ç—Å—è –≤ –æ–¥–∏–Ω –±–∞–π—Ç, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –±–∞–π—Ç—ã –≤ –∏–Ω—Ç—Ä—É–∫—Ü–∏–∏ —Ö—Ä–∞–Ω—è—Ç –µ–µ –æ–ø–µ—Ä–∞–Ω–¥—ã. –†–∞–∑–º–µ—Ä –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞–Ω–¥–æ–≤ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏, —Ç–∏–ø–∞ –æ–ø–µ—Ä–∞–Ω–¥–æ–≤ –∏
—Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö.  
  
–û–ø–∫–æ–¥ –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:  
`–∫–æ–¥ –æ–ø–µ—Ä–∞—Ü–∏–∏ (4 –±–∏—Ç–∞) + —Ç–∏–ø –æ–ø–µ—Ä–∞–Ω–¥–æ–≤ (2 –±–∏—Ç–∞) + —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö (2 –±–∏—Ç–∞)`

–î–ª—è –ø—Ä–∏–º–µ—Ä–∞, –±–∞–π—Ç–∫–æ–¥ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏  
`mov  r1, -1`  
–±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å, –∫–∞–∫  
`13 08 00 ff ff ff ff ff ff ff ff`

–û–ø–∫–æ–¥ `0x13` –∏–ª–∏ `0b[0001][00][11]`. –û—Ç—Å—é–¥–∞ –ø–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:
* —ç—Ç–æ `mov`, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –ª–µ–∂–∏—Ç –ø–æ–¥ –ø–µ—Ä–≤—ã–º –∏–Ω–¥–µ–∫—Å–æ–º –≤ –º–∞—Å—Å–∏–≤–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
* –Ω—É–ª–µ–≤—ã–µ –±–∏—Ç—ã —Ç–∏–ø–∞ –æ–ø–µ—Ä–∞–Ω–¥–æ–≤ –≥–ª–∞—Å—è—Ç, —á—Ç–æ —ç—Ç–æ –∞–¥—Ä–µ—Å –∏ –ª–∏—Ç–µ—Ä–∞–ª
* `0b11` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤ –∫–∞—á–µ—Ç—Å–≤–µ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö QWORD, —Ç–æ –µ—Å—Ç—å –∫–æ–Ω–µ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –∏–∑ —Å–µ–±—è –≤–æ—Å—å–º–∏–±–∞–π—Ç–Ω—ã–µ –∑–Ω–∞–∫–æ–≤—ã–µ —á–∏—Å–ª–∞.
  
–ü–µ—Ä–≤—ã–π –æ–ø–µ—Ä–∞–Ω–¥ –∞–¥—Ä–µ—Å, –∑–Ω–∞—á–∏—Ç —ç—Ç–æ —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ—Å–ª–µ –æ–ø–∫–æ–¥–∞ –¥–≤–∞ –±–∞–π—Ç–∞: `08 00`  
–î–µ–∫–æ–¥–∏—Ä—É–µ–º –∫–∞–∫ little-endian short –∏ –ø–æ–ª—É—á–∞–µ–º `8`  
  
–ù–æ –ø–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ? –ù–∞–ø–æ–∏–Ω–∞—é, –≤—Å–µ –º–µ—Ç–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –∏–∑ —Å–µ–±—è –º–∞–∫—Ä–æ—Å—ã, –∑–∞–º–µ–Ω—è–µ–º—ã–π –Ω–∞ –∞–¥—Ä–µ—Å–∞, –∞ –∞–¥—Ä–µ—Å–∞ –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å —è–≤–ª—è—é—Ç—Å—è —Å–º–µ—â–µ–Ω–∏–µ–º –æ—Ç –Ω–∞—á–∞–ª–∞ —Å–µ–≥–º–µ–Ω—Ç–∞.
–í—Å–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã –ª–µ–∂–∏—Ç –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ —Å–µ–≥–º–µ–Ω—Ç–∞ –¥–∞–Ω–Ω—ã—Ö, –∞ `r1` –ª–µ–∂–∏—Ç —Å–æ —Å–º–µ—â–µ–Ω–∏–µ–º –≤ –≤–æ—Å–µ–º—å –±–∞–π—Ç–æ–≤ –æ—Ç –Ω–∞—á–∞–ª–∞ —Å–µ–≥–º–µ–Ω—Ç–∞.  

–í—Ç–æ—Ä–æ–π –æ–ø–µ—Ä–∞–Ω–¥ –∫–æ–¥–∏—Ä—É–µ—Ç –ª–∏—Ç–µ—Ä–∞–ª - –≤–æ—Å—å–º–∏–±–∞–π—Ç–Ω–æ–µ –∑–Ω–∞–∫–æ–≤–æ–µ —á–∏—Å–ª–æ - –∫–æ—Ç–æ—Ä—ã–π —Å–ª–µ–¥—É–µ—Ç –ø–æ–º–µ—Å—Ç–∏—Ç—å –ø–æ –∞–¥—Ä–µ—Å—É, –Ω–∞—Ö–æ–¥—è—â–µ–º—Å—è –≤ –ø–µ—Ä–≤–æ–º –æ–ø–µ—Ä–∞–Ω–¥–µ.
–í—Å–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞ –∫–æ–¥–∏—Ä—É—é—Ç—Å—è –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –∫–æ–¥–µ. 

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
–í —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è 16-—Ç–∏ –±–∞–π—Ç–∞—è (—Å —É—á–µ—Ç–æ–º –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è) —Å—Ç—Ä—É–∫—Ç—É—Ä–∞  
  
![–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ](https://github.com/lockheeed/ufo-vm/assets/47332822/3faaefee-c8f1-4dd9-9a97-ea9ff402719a)  
  
–°—Ä–∞–∑—É –∑–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è —Å–µ–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –∏ —Å–µ–≥–º–µ–Ω—Ç –¥–∞–Ω–Ω—ã—Ö.
  
## –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞
–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `test-programs` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –¥–≤–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–µ –≤—Å–µ –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –≤—ã—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –∏ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞.  
